<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <title>Dashboard de Previs√µes</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="../static/style-dashboard.css" />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style-dashboard.css') }}"
    />
  </head>
  <body>
    <header>
      <div class="titulo_page">
        <h2>Dashboard de Previs√µes</h2>
      </div>

      <nav class="menu-desktop">
        <ul>
          <li><a href="">Home</a></li>
          <li><a href="/NovaConsulta">Nova Consulta</a></li>
          <li><a href="dashboard">Dashboard</a></li>
        </ul>
      </nav>
    </header>

    <h3 id="titulo-classes">Distribui√ß√£o das classes preditas</h3>
    <h3 id="titulo-genero">Percentual de Homens e Mulheres que Ganham > 50K</h3>
    <h3 id="titulo-ocupacao">Percentual com Renda > 50K por Ocupa√ß√£o</h3>
    
    <div style="max-width: 900px; margin: auto;">
      <canvas id="graficoUnico"></canvas>
    </div>


    <h3>Dados Armazenados</h3>
    <table>
      <tr>
        <th>Idade</th>
        <th>G√™nero</th>
        <th>Ocupa√ß√£o</th>
        <th>Educa√ß√£o</th>
        <th>Capital Ganho</th>
        <th>Previs√£o</th>
      </tr>
      {% for d in dados %}
      <tr>
        <td>{{ d.idade }}</td>
        <td>{{ d.genero }}</td>
        <td>{{ d.ocupacao }}</td>
        <td>{{ d.educacao }}</td>
        <td>{{ d.capital_gain }}</td>
        <td>{{ d.previsao }}</td>
      </tr>
      {% endfor %}
    </table>





    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const ctx = document.getElementById('graficoUnico').getContext('2d');
      
        // Inicializa o gr√°fico com dados vazios
        const grafico = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: [],
            datasets: [{
              label: '',
              data: [],
              backgroundColor: [],
            }]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { display: false },
              title: { display: true, text: '' }
            },
            scales: {
              y: {
                beginAtZero: true,
                max: 100,
                ticks: {
                  callback: value => value + '%'
                }
              }
            }
          }
        });
      
        // üéØ Fun√ß√µes para atualizar os dados conforme o gr√°fico desejado
        function mostrarGraficoClasses() {
          grafico.data.labels = ['<= 50K', '> 50K'];
          grafico.data.datasets[0].data = [{{ percentual_0|round(2) }}, {{ percentual_1|round(2) }}];
          grafico.data.datasets[0].backgroundColor = ['#36A2EB', '#FF6384'];
          grafico.options.plugins.title.text = 'Distribui√ß√£o das Classes Preditas';
          grafico.update();
        }
      
        function mostrarGraficoGenero() {
          grafico.data.labels = ['Homens', 'Mulheres'];
          grafico.data.datasets[0].data = [{{ percentual_homens_mais_50k|round(2) }}, {{ percentual_mulheres_mais_50k|round(2) }}];
          grafico.data.datasets[0].backgroundColor = ['#4B9CD3', '#F675A8'];
          grafico.options.plugins.title.text = 'Percentual com Renda > 50K por G√™nero';
          grafico.update();
        }
      
        function mostrarGraficoOcupacao() {
          grafico.data.labels = {{ labels_ocupacao|tojson }};
          grafico.data.datasets[0].data = {{ percentuais_ocupacao|tojson }};
          grafico.data.datasets[0].backgroundColor = '#36A2EB';
          grafico.options.plugins.title.text = 'Percentual com Renda > 50K por Ocupa√ß√£o';
          grafico.update();
        }
      
        
        document.getElementById('titulo-classes').addEventListener('mouseover', mostrarGraficoClasses);
        document.getElementById('titulo-genero').addEventListener('mouseover', mostrarGraficoGenero);
        document.getElementById('titulo-ocupacao').addEventListener('mouseover', mostrarGraficoOcupacao);
      
        // Mostra o primeiro gr√°fico por padr√£o
        mostrarGraficoClasses();
      });
      </script>
      
  </body>
</html>
